<!DOCTYPE html>
<html>
<head>
    <title>Google Docs</title>
    <style>
        /* THEME COLOR: MIDNIGHT BLUE */
        :root { 
            --bg: #020617;        /* Very dark blue */
            --card: #0f172a;      /* Slate blue */
            --accent: #3b82f6;    /* Bright blue */
            --text: #f8fafc; 
        }

        body { 
            background-color: var(--bg); 
            color: var(--text); 
            font-family: 'Segoe UI', sans-serif; 
            margin: 0; 
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }

        /* This ensures the color shows even if the image is missing */
        .bg-overlay { 
            position: fixed; 
            top: 0; left: 0; width: 100%; height: 100%; 
            background: linear-gradient(180deg, rgba(2, 6, 23, 0.8) 0%, rgba(2, 6, 23, 1) 100%); 
            z-index: -1; 
        }

        .navbar { 
            background: rgba(15, 23, 42, 0.9); 
            backdrop-filter: blur(10px); 
            padding: 15px 30px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            border-bottom: 1px solid #1e293b; 
            position: sticky; top: 0; z-index: 1000; 
        }

        .container { padding: 30px 20px; max-width: 1400px; margin: 0 auto; }
        
        .grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); 
            gap: 25px; 
            margin-bottom: 40px; 
        }

        .game-card { 
            background: var(--card); 
            border-radius: 20px; 
            border: 1px solid #1e293b; 
            padding: 20px 10px; 
            text-align: center; 
            cursor: pointer; 
            transition: 0.3s; 
            position: relative; 
        }

        .game-card:hover { 
            transform: translateY(-5px); 
            border-color: var(--accent); 
            box-shadow: 0 0 25px rgba(59, 130, 246, 0.2);
        }

        .logo-box { width: 70px; height: 70px; margin: 0 auto 10px; font-size: 45px; display: flex; align-items: center; justify-content: center; }
        .section-header { border-left: 5px solid var(--accent); padding-left: 15px; margin: 30px 0 15px; font-size: 22px; color: #fff; }
        
        .btn-ui { 
            background: #1e293b; 
            border: 1px solid #334155; 
            color: white; 
            padding: 10px 18px; 
            border-radius: 10px; 
            cursor: pointer; 
            font-weight: bold; 
        }

        #search { 
            padding: 10px 15px; 
            border-radius: 10px; 
            border: 1px solid #334155; 
            background: #020617; 
            color: white; 
            width: 220px; 
        }

        .footer-nav { position: fixed; bottom: 15px; right: 25px; display: flex; gap: 10px; }
        .footer-nav a, .footer-nav button { 
            background: #1e293b; 
            color: #fff; 
            padding: 8px 15px; 
            border-radius: 8px; 
            text-decoration: none; 
            font-size: 13px; 
            font-weight: bold; 
            border: 1px solid var(--accent); 
        }

        #authModal { 
            position:fixed; top:0; left:0; width:100%; height:100%; 
            background:var(--bg); z-index:10000; 
            display:flex; justify-content:center; align-items:center; flex-direction:column;
        }
    </style>
</head>
<body>
    <div id="authModal" style="display:none;">
        <h1 style="color:var(--accent); font-size: 3rem; margin-bottom: 10px;">MONGLE</h1>
        <p style="margin-bottom: 20px;">Enter a username to begin</p>
        <input type="text" id="usernameInput" placeholder="Username..." style="padding:15px; border-radius:10px; width:280px; border:1px solid var(--accent); background:#000; color:#fff; margin-bottom:15px;">
        <button class="btn-ui" style="background:var(--accent); width: 280px;" onclick="createAccount()">Start Gaming</button>
    </div>

    <div class="bg-overlay"></div>
    
    <div class="navbar">
        <div id="clock" style="color: var(--accent); font-weight: bold; font-family: monospace; font-size: 1.2rem;">00:00:00</div>
        <div id="userDisplay" style="font-weight:bold; color: var(--accent);"></div>
        <div style="display:flex; gap:10px;">
            <input type="text" id="search" placeholder="Search..." onkeyup="filter()">
            <button class="btn-ui" onclick="panic()" style="background:#ef4444; border:none;">Panic</button>
        </div>
    </div>

    <div class="container">
        <div id="lastPlayedSection" style="display:none;">
            <h2 class="section-header">üïí Recently Played</h2>
            <div id="lastPlayedGrid" class="grid"></div>
        </div>
        <div id="favSection" style="display:none;"><h2 class="section-header">‚≠ê Your Favorites</h2><div id="favGrid" class="grid"></div></div>
        <div id="fnafSection" style="display:none;"><h2 class="section-header">üêª FNAF Collection</h2><div id="fnafGrid" class="grid"></div></div>
        <h2 class="section-header">üïπÔ∏è All Games</h2>
        <div id="gameGrid" class="grid"></div>
    </div>

    <div class="footer-nav">
        <button onclick="logout()" style="cursor:pointer;">üö™ Logout</button>
        <a href="wiki.html?mode=user">‚öôÔ∏è Settings</a>
        <a href="wiki.html?mode=admin" id="adminBtn" style="display:none; background:#ef4444; border:none;">üîë Super Admin</a>
    </div>

    <script>
        const USER = "bob154526-hue"; const REPO = "Mongle";
        
        // Account Logic
        if(!localStorage.getItem('mUser')) { 
            document.getElementById('authModal').style.display = 'flex'; 
        } else { 
            document.getElementById('userDisplay').innerText = "üë§ " + localStorage.getItem('mUser').toUpperCase(); 
        }

        function createAccount() {
            const val = document.getElementById('usernameInput').value;
            if(val.length > 1) { localStorage.setItem('mUser', val); location.reload(); }
        }
        function logout() { localStorage.removeItem('mUser'); location.reload(); }

        // Clock
        function updateClock() { document.getElementById('clock').innerText = new Date().toLocaleTimeString(); }
        setInterval(updateClock, 1000); updateClock();

        function filter() {
            let q = document.getElementById('search').value.toLowerCase();
            document.getElementById('adminBtn').style.display = (q === "admin") ? "block" : "none";
            document.querySelectorAll('.game-card').forEach(c => {
                c.style.display = c.innerText.toLowerCase().includes(q) ? "" : "none";
            });
        }

        async function launch(url, name) {
            localStorage.setItem('lastPlayed', name);
            const res = await fetch(url); const code = await res.text();
            const blobUrl = URL.createObjectURL(new Blob([code], { type: 'text/html' }));
            window.location.href = blobUrl;
        }

        function toggleFav(e, fileName) {
            e.stopPropagation();
            let favs = JSON.parse(localStorage.getItem('userFavs')) || [];
            favs = favs.includes(fileName) ? favs.filter(f => f !== fileName) : [...favs, fileName];
            localStorage.setItem('userFavs', JSON.stringify(favs));
            autoScan();
        }

        async function autoScan() {
            const res = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/`);
            const files = await res.json();
            const gGrid = document.getElementById('gameGrid');
            const fGrid = document.getElementById('fnafGrid');
            const favGrid = document.getElementById('favGrid');
            const lastGrid = document.getElementById('lastPlayedGrid');
            
            gGrid.innerHTML = ""; fGrid.innerHTML = ""; favGrid.innerHTML = ""; lastGrid.innerHTML = "";
            
            const favs = JSON.parse(localStorage.getItem('userFavs')) || [];
            const forcedEmoji = localStorage.getItem('globalEmoji');
            const lastPlayed = localStorage.getItem('lastPlayed');

            files.filter(f => f.name.endsWith('.html') && !['index.html', 'wiki.html'].includes(f.name)).forEach(file => {
                const name = file.name.replace('.html', '');
                const card = document.createElement('div'); card.className = 'game-card';
                card.onclick = () => launch(file.download_url, name);
                
                const emoji = forcedEmoji || 'üéÆ';
                const isFav = favs.includes(file.name);
                
                card.innerHTML = `
                    <div class="fav-star ${isFav?'active':''}" onclick="toggleFav(event,'${file.name}')" style="position:absolute; top:10px; right:10px; filter:${isFav?'grayscale(0)':'grayscale(1)'}">‚≠ê</div>
                    <div class="logo-box">${emoji}</div>
                    <div class="game-name">${name}</div>
                `;
                
                if(isFav) { 
                    document.getElementById('favSection').style.display='block'; 
                    let clone = card.cloneNode(true);
                    clone.onclick = card.onclick;
                    clone.querySelector('.fav-star').onclick = (e) => toggleFav(e, file.name);
                    favGrid.appendChild(clone);
                }
                if(name === lastPlayed) { 
                    document.getElementById('lastPlayedSection').style.display='block'; 
                    let clone = card.cloneNode(true);
                    clone.onclick = card.onclick;
                    clone.querySelector('.fav-star').onclick = (e) => toggleFav(e, file.name);
                    lastGrid.appendChild(clone); 
                }
                if(name.toLowerCase().match(/fnaf|five nights|freddy/)) { 
                    document.getElementById('fnafSection').style.display='block'; 
                    fGrid.appendChild(card); 
                }
                else { gGrid.appendChild(card); }
            });
        }
        function panic() { window.location.replace(localStorage.getItem('panicKey_user') || 'https://classroom.google.com'); }
        autoScan();
    </script>
</body>
</html>
